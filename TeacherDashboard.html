<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Teacher Dashboard - Student Management System</title>
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-bg: #ecf0f1;
            --white-bg: #ffffff;
            --text-primary: #2c3e50;
            --text-secondary: #7f8c8d;
            --border-color: #bdc3c7;
            --shadow: 0 4px 15px rgba(0, 0, 0, 0.1);
            --border-radius: 12px;
            --gradient-primary: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --gradient-success: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        [data-theme="dark"] {
            --light-bg: #1a1a1a;
            --white-bg: #2d2d2d;
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --border-color: #404040;
            --primary-color: #3498db;
            --shadow: 0 4px 15px rgba(255, 255, 255, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: var(--light-bg);
            color: var(--text-primary);
            line-height: 1.6;
            transition: all 0.3s ease;
            overflow-x: hidden;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Header Styles */
        .header {
            background: var(--gradient-primary);
            color: white;
            border-radius: var(--border-radius);
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 20px;
            position: relative;
            overflow: hidden;
        }

        .header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="50" cy="50" r="0.5" fill="%23ffffff" opacity="0.1"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
        }

        .header-content {
            position: relative;
            z-index: 1;
        }

        .header-content h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 8px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .header-content p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        .header-controls {
            display: flex;
            gap: 15px;
            align-items: center;
            position: relative;
            z-index: 1;
        }

        .theme-toggle, .notification-btn {
            background: rgba(255, 255, 255, 0.2);
            color: white;
            border: 2px solid rgba(255, 255, 255, 0.3);
            padding: 12px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
        }

        .theme-toggle:hover, .notification-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
        }

        /* Navigation Tabs */
        .nav-tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            background: var(--white-bg);
            padding: 10px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow-x: auto;
        }

        .nav-tab {
            padding: 15px 25px;
            border: none;
            background: transparent;
            color: var(--text-secondary);
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            white-space: nowrap;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .nav-tab:hover {
            background: var(--light-bg);
            color: var(--text-primary);
        }

        .nav-tab.active {
            background: var(--secondary-color);
            color: white;
            box-shadow: 0 4px 15px rgba(52, 152, 219, 0.3);
        }

        /* Tab Content */
        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Card Styles */
        .card {
            background: var(--white-bg);
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            margin-bottom: 30px;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.15);
        }

        .card-title {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .card-icon {
            font-size: 1.8rem;
        }

        /* Form Styles */
        .form-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--text-primary);
            font-size: 1rem;
        }

        .form-group input, .form-group select, .form-group textarea {
            width: 100%;
            padding: 16px 20px;
            border: 2px solid var(--border-color);
            border-radius: 10px;
            font-size: 1rem;
            background: var(--white-bg);
            color: var(--text-primary);
            transition: all 0.3s ease;
        }

        .form-group input:focus, .form-group select:focus, .form-group textarea:focus {
            outline: none;
            border-color: var(--secondary-color);
            box-shadow: 0 0 0 4px rgba(52, 152, 219, 0.1);
            transform: translateY(-2px);
        }

        .form-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        /* Gender Selection */
        .gender-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 8px;
        }

        .gender-btn {
            padding: 18px;
            border: 2px solid var(--border-color);
            background: var(--white-bg);
            border-radius: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-align: center;
            font-size: 1.1rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .gender-btn:hover {
            border-color: var(--secondary-color);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        }

        .gender-btn.selected {
            background: var(--secondary-color);
            color: white;
            border-color: var(--secondary-color);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
        }

        /* Button Styles */
        .btn {
            background: var(--primary-color);
            color: white;
            padding: 16px 32px;
            border: none;
            border-radius: 10px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            gap: 10px;
            text-decoration: none;
            justify-content: center;
        }

        .btn:hover {
            background: var(--secondary-color);
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(52, 152, 219, 0.3);
        }

        .btn-success { 
            background: var(--success-color); 
        }

        .btn-success:hover { 
            background: #229954; 
            box-shadow: 0 8px 25px rgba(39, 174, 96, 0.3);
        }

        .btn-warning { 
            background: var(--warning-color); 
        }

        .btn-warning:hover { 
            background: #d68910; 
            box-shadow: 0 8px 25px rgba(243, 156, 18, 0.3);
        }

        .btn-danger { 
            background: var(--danger-color); 
        }

        .btn-danger:hover { 
            background: #c0392b; 
            box-shadow: 0 8px 25px rgba(231, 76, 60, 0.3);
        }

        .btn-outline {
            background: transparent;
            color: var(--primary-color);
            border: 2px solid var(--primary-color);
        }

        .btn-outline:hover {
            background: var(--primary-color);
            color: white;
        }

        /* Action Grid */
        .actions-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        /* File Upload */
        .file-upload-area {
            border: 3px dashed var(--border-color);
            border-radius: 15px;
            padding: 40px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            background: var(--light-bg);
        }

        .file-upload-area:hover,
        .file-upload-area.dragover {
            border-color: var(--success-color);
            background: rgba(39, 174, 96, 0.1);
            transform: scale(1.02);
        }

        .upload-icon {
            font-size: 4rem;
            color: var(--text-secondary);
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .file-upload-area:hover .upload-icon {
            color: var(--success-color);
            transform: scale(1.1);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.6);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background-color: var(--white-bg);
            margin: 2% auto;
            padding: 40px;
            border-radius: var(--border-radius);
            width: 95%;
            max-width: 1200px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            transform: scale(0.9);
            transition: all 0.3s ease;
        }

        .modal.show .modal-content {
            transform: scale(1);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid var(--border-color);
        }

        .modal-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: var(--primary-color);
            margin: 0;
        }

        .close {
            color: var(--text-secondary);
            font-size: 2rem;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .close:hover {
            color: var(--danger-color);
            transform: scale(1.1);
        }

        /* Table Styles */
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
            background: var(--white-bg);
            border-radius: 10px;
            overflow: hidden;
            box-shadow: var(--shadow);
        }

        .data-table th, .data-table td {
            padding: 15px 20px;
            text-align: left;
            border-bottom: 1px solid var(--border-color);
        }

        .data-table th {
            background: var(--light-bg);
            font-weight: 700;
            color: var(--text-primary);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .data-table tr:hover {
            background: rgba(52, 152, 219, 0.05);
        }

        .data-table tr:last-child td {
            border-bottom: none;
        }

        /* Student Cards */
        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .student-card {
            background: var(--white-bg);
            border-radius: 15px;
            padding: 25px;
            box-shadow: var(--shadow);
            border: 1px solid var(--border-color);
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .student-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-success);
        }

        .student-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        .student-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 20px;
        }

        .student-info h4 {
            color: var(--primary-color);
            font-size: 1.3rem;
            font-weight: 700;
            margin-bottom: 8px;
        }

        .student-meta {
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        .student-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.9rem;
        }

        /* Filters */
        .filters-bar {
            background: var(--white-bg);
            padding: 25px;
            border-radius: var(--border-radius);
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }

        .filters-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            align-items: end;
        }

        .search-box {
            position: relative;
        }

        .search-box input {
            padding-left: 50px;
        }

        .search-icon {
            position: absolute;
            left: 18px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--text-secondary);
            font-size: 1.2rem;
        }

        /* Alerts */
        .alert {
            padding: 16px 24px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 600;
            animation: slideIn 0.3s ease;
        }

        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-left: 4px solid var(--success-color);
        }

        .alert-error {
            background: #f8d7da;
            color: #721c24;
            border-left: 4px solid var(--danger-color);
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-left: 4px solid var(--warning-color);
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-left: 4px solid var(--secondary-color);
        }

        /* Statistics Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: var(--white-bg);
            padding: 30px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            text-align: center;
            position: relative;
            overflow: hidden;
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: var(--gradient-primary);
        }

        .stat-number {
            font-size: 2.5rem;
            font-weight: 800;
            color: var(--primary-color);
            margin-bottom: 8px;
        }

        .stat-label {
            font-size: 1rem;
            color: var(--text-secondary);
            font-weight: 600;
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Progress Bar */
        .progress-bar {
            width: 100%;
            height: 8px;
            background: var(--light-bg);
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }

        .progress-fill {
            height: 100%;
            background: var(--gradient-success);
            border-radius: 4px;
            transition: width 0.3s ease;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .header {
                padding: 20px;
                text-align: center;
            }

            .header-content h1 {
                font-size: 2rem;
            }

            .nav-tabs {
                flex-wrap: wrap;
            }

            .form-grid {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .filters-grid {
                grid-template-columns: 1fr;
            }

            .students-grid {
                grid-template-columns: 1fr;
            }

            .modal-content {
                margin: 5% auto;
                padding: 25px;
            }

            .actions-grid {
                grid-template-columns: 1fr;
            }

            .student-actions {
                flex-direction: column;
            }
        }

        @media (max-width: 480px) {
            .header-content h1 {
                font-size: 1.5rem;
            }

            .header-content p {
                font-size: 1rem;
            }

            .card {
                padding: 20px;
            }

            .btn {
                padding: 12px 20px;
                font-size: 0.9rem;
            }
        }

        /* Utility Classes */
        .hidden { display: none !important; }
        .text-center { text-align: center; }
        .text-right { text-align: right; }
        .mt-20 { margin-top: 20px; }
        .mb-20 { margin-bottom: 20px; }
        .p-relative { position: relative; }

        /* Dark mode specific adjustments */
        [data-theme="dark"] .stat-card::before,
        [data-theme="dark"] .student-card::before {
            background: var(--gradient-success);
        }

        [data-theme="dark"] .data-table th {
            background: var(--primary-color);
            color: white;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <div class="header-content">
                <h1>👨‍🏫 Teacher Dashboard</h1>
                <p>Student Profile Management System</p>
            </div>
            <div class="header-controls">
                <button class="notification-btn" onclick="showNotifications()">
                    🔔 Notifications
                </button>
                <button class="theme-toggle" onclick="toggleTheme()">
                    🌙 Dark Mode
                </button>
            </div>
        </div>

        <!-- Statistics Overview -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" id="totalStudents">0</div>
                <div class="stat-label">Total Students</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="pendingProfiles">0</div>
                <div class="stat-label">Pending Profiles</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="completedProfiles">0</div>
                <div class="stat-label">Completed Profiles</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="maleStudents">0</div>
                <div class="stat-label">Male Students</div>
            </div>
        </div>

        <!-- Navigation Tabs -->
        <div class="nav-tabs">
            <button class="nav-tab active" onclick="showTab('student-entry')">
                👤 Add Student
            </button>
            <button class="nav-tab" onclick="showTab('bulk-upload')">
                📊 Bulk Upload
            </button>
            <button class="nav-tab" onclick="showTab('view-students')">
                👥 View Students
            </button>
            <button class="nav-tab" onclick="showTab('search-edit')">
                🔍 Search & Edit
            </button>
            <button class="nav-tab" onclick="showTab('reports')">
                📈 Reports
            </button>
        </div>

        <!-- Tab: Student Entry -->
        <div class="tab-content active" id="student-entry">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-icon">👤</span>
                    Student Profile Entry
                </h2>
                
                <form id="studentForm">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="rollNumber">Roll Number *</label>
                            <input type="text" id="rollNumber" name="rollNumber" placeholder="Enter roll number" required>
                        </div>
                        <div class="form-group">
                            <label for="regNumber">Register Number *</label>
                            <input type="text" id="regNumber" name="regNumber" placeholder="Enter register number" required>
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="studentName">Student Full Name *</label>
                        <input type="text" id="studentName" name="studentName" placeholder="Enter student's full name" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="class">Class *</label>
                            <input type="text" id="class" name="class" placeholder="Enter class (e.g., 1, 2, 10, 12)" required>
                        </div>
                        <div class="form-group">
                            <label for="division">Division *</label>
                            <input type="text" id="division" name="division" placeholder="Enter division (e.g., A, B, C)" required>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="dob">Date of Birth *</label>
                            <input type="date" id="dob" name="dob" onchange="calculateAge()" required>
                        </div>
                        <div class="form-group">
                            <label for="age">Age (Auto-calculated)</label>
                            <input type="number" id="age" name="age" readonly style="background: var(--light-bg);">
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Gender *</label>
                        <div class="gender-buttons">
                            <div class="gender-btn" onclick="selectGender('M')" data-gender="M">
                                👦 Male
                            </div>
                            <div class="gender-btn" onclick="selectGender('F')" data-gender="F">
                                👧 Female
                            </div>
                        </div>
                        <input type="hidden" id="gender" name="gender" required>
                    </div>

                    <div class="form-row">
                        <div class="form-group">
                            <label for="height">Height (cm) *</label>
                            <input type="number" id="height" name="height" placeholder="e.g., 165" step="0.1" min="80" max="250" required>
                        </div>
                        <div class="form-group">
                            <label for="weight">Weight (kg) *</label>
                            <input type="number" id="weight" name="weight" placeholder="e.g., 55.5" step="0.1" min="10" max="200" required>
                        </div>
                    </div>

                    <div class="actions-grid">
                        <button type="submit" class="btn btn-success">
                            💾 Save Student
                        </button>
                        <button type="button" class="btn btn-warning" onclick="clearForm()">
                            🔄 Clear Form
                        </button>
                        <button type="button" class="btn btn-outline" onclick="saveAndAddNew()">
                            ➕ Save & Add New
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Tab: Bulk Upload -->
        <div class="tab-content" id="bulk-upload">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-icon">📊</span>
                    Bulk Student Upload
                </h2>
                
                <div class="file-upload-area" onclick="document.getElementById('excelInput').click()">
                    <div class="upload-icon">📄</div>
                    <h3>Upload Excel/CSV File</h3>
                    <p>Supported formats: .xlsx, .xls, .csv</p>
                    <p style="margin-top: 10px; font-size: 0.9rem; color: var(--text-secondary);">
                        Click here or drag & drop your file
                    </p>
                    <input type="file" id="excelInput" accept=".xlsx,.xls,.csv" style="display: none;" onchange="handleFileUpload(event)">
                </div>

                <div id="filePreview" class="hidden mt-20">
                    <div style="background: var(--light-bg); padding: 20px; border-radius: 10px; border: 2px solid var(--success-color);">
                        <div style="display: flex; align-items: center; gap: 15px;">
                            <div style="font-size: 2rem;">📄</div>
                            <div style="flex: 1;">
                                <h4 id="fileName" style="color: var(--success-color); margin: 0 0 5px 0;">File Selected</h4>
                                <p id="fileDetails" style="color: var(--text-secondary); margin: 0; font-size: 0.9rem;">File details</p>
                            </div>
                            <button class="btn btn-outline btn-sm" onclick="removeFile()" style="padding: 8px 16px;">
                                🗑️ Remove
                            </button>
                        </div>
                    </div>
                </div>

                <div id="uploadProgress" class="hidden mt-20">
                    <div style="background: var(--white-bg); padding: 20px; border-radius: 10px; border: 2px solid var(--secondary-color);">
                        <h4 style="color: var(--secondary-color); margin: 0 0 15px 0;">Processing File...</h4>
                        <div class="progress-bar">
                            <div class="progress-fill" id="progressFill" style="width: 0%"></div>
                        </div>
                        <p id="progressText" class="text-center mt-20">Preparing upload...</p>
                    </div>
                </div>

                <div id="uploadResults" class="hidden mt-20">
                    <div style="background: var(--light-bg); padding: 20px; border-radius: 10px;">
                        <h4 style="color: var(--success-color); margin: 0 0 15px 0;">✅ Upload Completed!</h4>
                        <div id="resultsContent"></div>
                        <button class="btn btn-success mt-20" onclick="resetUpload()">
                            ➕ Upload Another File
                        </button>
                    </div>
                </div>

                <div class="mt-20">
                    <h3>📋 Required Excel Format:</h3>
                    <div style="overflow-x: auto;">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Roll Number</th>
                                    <th>Register Number</th>
                                    <th>Student Name</th>
                                    <th>Class</th>
                                    <th>Division</th>
                                    <th>DOB (YYYY-MM-DD)</th>
                                    <th>Gender (M/F)</th>
                                    <th>Height (cm)</th>
                                    <th>Weight (kg)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>2024001</td>
                                    <td>REG001</td>
                                    <td>John Doe</td>
                                    <td>10</td>
                                    <td>A</td>
                                    <td>2008-05-15</td>
                                    <td>M</td>
                                    <td>165</td>
                                    <td>55</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="actions-grid mt-20">
                    <button class="btn" onclick="downloadTemplate()">
                        📥 Download Template
                    </button>
                    <button class="btn btn-success" onclick="processUploadedFile()" id="processBtn" disabled>
                        🚀 Process Upload
                    </button>
                </div>
            </div>
        </div>

        <!-- Tab: View Students -->
        <div class="tab-content" id="view-students">
            <div class="filters-bar">
                <div class="filters-grid">
                    <div class="form-group">
                        <label>Search Students</label>
                        <div class="search-box">
                            <span class="search-icon">🔍</span>
                            <input type="text" id="searchInput" placeholder="Search by name, roll number..." onkeyup="filterStudents()">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>Filter by Gender</label>
                        <select id="genderFilter" onchange="filterStudents()">
                            <option value="">All Genders</option>
                            <option value="M">Male</option>
                            <option value="F">Female</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Filter by Class</label>
                        <select id="classFilter" onchange="filterStudents()">
                            <option value="">All Classes</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Filter by Division</label>
                        <select id="divisionFilter" onchange="filterStudents()">
                            <option value="">All Divisions</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <button class="btn" onclick="clearFilters()">
                            🔄 Clear Filters
                        </button>
                    </div>
                </div>
            </div>

            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                    <h2 class="card-title" style="margin: 0;">
                        <span class="card-icon">👥</span>
                        All Students
                    </h2>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn btn-outline" onclick="toggleViewMode()">
                            📋 Table View
                        </button>
                        <button class="btn" onclick="loadStudents()">
                            🔄 Refresh
                        </button>
                    </div>
                </div>

                <div id="studentsContainer">
                    <div class="students-grid" id="studentsGrid">
                        <!-- Students will be loaded here -->
                    </div>
                    <div class="hidden" id="studentsTable">
                        <table class="data-table">
                            <thead>
                                <tr>
                                    <th>Roll No.</th>
                                    <th>Name</th>
                                    <th>Class</th>
                                    <th>Gender</th>
                                    <th>Age</th>
                                    <th>Height</th>
                                    <th>Weight</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody id="studentsTableBody">
                                <!-- Table data will be loaded here -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div id="loadingIndicator" class="text-center mt-20 hidden">
                    <div class="loading"></div>
                    <p>Loading students...</p>
                </div>
            </div>
        </div>

        <!-- Tab: Search & Edit -->
        <div class="tab-content" id="search-edit">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-icon">🔍</span>
                    Advanced Search & Edit
                </h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Search Method</label>
                        <select id="searchMethod" onchange="updateSearchPlaceholder()">
                            <option value="general">General Search</option>
                            <option value="roll_number">By Roll Number</option>
                            <option value="reg_number">By Register Number</option>
                            <option value="name">By Name</option>
                            <option value="class_division">By Class & Division</option>
                            <option value="contact">By Parent Contact</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Search Term</label>
                        <div class="search-box">
                            <span class="search-icon">🔍</span>
                            <input type="text" id="advancedSearchInput" placeholder="Enter search term...">
                        </div>
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <button class="btn btn-success" onclick="performAdvancedSearch()">
                            🔍 Search
                        </button>
                    </div>
                </div>

                <div id="searchResults" class="mt-20 hidden">
                    <h3>Search Results:</h3>
                    <div id="searchResultsContainer"></div>
                </div>
            </div>
        </div>

        <!-- Tab: Reports -->
        <div class="tab-content" id="reports">
            <div class="card">
                <h2 class="card-title">
                    <span class="card-icon">📈</span>
                    Student Reports & Analytics
                </h2>
                
                <div class="form-row">
                    <div class="form-group">
                        <label>Report Type</label>
                        <select id="reportType">
                            <option value="class_wise">Class-wise Summary</option>
                            <option value="gender_wise">Gender-wise Distribution</option>
                            <option value="age_wise">Age Group Analysis</option>
                            <option value="height_weight">Height-Weight Statistics</option>
                            <option value="complete_list">Complete Student List</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>Export Format</label>
                        <select id="exportFormat">
                            <option value="pdf">PDF Report</option>
                            <option value="excel">Excel Spreadsheet</option>
                            <option value="csv">CSV File</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>&nbsp;</label>
                        <button class="btn btn-success" onclick="generateReport()">
                            📊 Generate Report
                        </button>
                    </div>
                </div>

                <div id="reportPreview" class="mt-20 hidden">
                    <h3>Report Preview:</h3>
                    <div id="reportContent"></div>
                </div>
            </div>
        </div>

        <!-- Alert Container -->
        <div id="alertContainer" style="position: fixed; top: 20px; right: 20px; z-index: 2000; max-width: 400px;"></div>
    </div>

    <!-- Edit Student Modal -->
    <div id="editStudentModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">✏️ Edit Student Profile</h2>
                <span class="close" onclick="closeModal('editStudentModal')">&times;</span>
            </div>
            <form id="editStudentForm">
                <input type="hidden" id="editStudentId" name="studentId">
                
                <div class="form-row">
                    <div class="form-group">
                        <label for="editRollNumber">Roll Number</label>
                        <input type="text" id="editRollNumber" name="rollNumber" required>
                    </div>
                    <div class="form-group">
                        <label for="editRegNumber">Register Number</label>
                        <input type="text" id="editRegNumber" name="regNumber" required>
                    </div>
                </div>

                <div class="form-group">
                    <label for="editStudentName">Student Name</label>
                    <input type="text" id="editStudentName" name="studentName" required>
                </div>

                        <div class="form-row">
                            <div class="form-group">
                                <label for="editClass">Class</label>
                                <input type="text" id="editClass" name="class" placeholder="Enter class" required>
                            </div>
                            <div class="form-group">
                                <label for="editDivision">Division</label>
                                <input type="text" id="editDivision" name="division" placeholder="Enter division" required>
                            </div>
                        </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editDob">Date of Birth</label>
                        <input type="date" id="editDob" name="dob" onchange="calculateEditAge()">
                    </div>
                    <div class="form-group">
                        <label for="editAge">Age</label>
                        <input type="number" id="editAge" name="age" readonly>
                    </div>
                </div>

                <div class="form-group">
                    <label>Gender</label>
                    <div class="gender-buttons">
                        <div class="gender-btn" onclick="selectEditGender('M')" data-gender="M">
                            👦 Male
                        </div>
                        <div class="gender-btn" onclick="selectEditGender('F')" data-gender="F">
                            👧 Female
                        </div>
                    </div>
                    <input type="hidden" id="editGender" name="gender">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="editHeight">Height (cm)</label>
                        <input type="number" id="editHeight" name="height" step="0.1" min="80" max="250">
                    </div>
                    <div class="form-group">
                        <label for="editWeight">Weight (kg)</label>
                        <input type="number" id="editWeight" name="weight" step="0.1" min="10" max="200">
                    </div>
                </div>

                <div class="form-group">
                    <label for="editParentContact">Parent Contact</label>
                    <input type="tel" id="editParentContact" name="parentContact">
                </div>

                <div class="form-group">
                    <label for="editAddress">Address</label>
                    <textarea id="editAddress" name="address" rows="3"></textarea>
                </div>

                <div class="actions-grid">
                    <button type="submit" class="btn btn-success">
                        💾 Update Student
                    </button>
                    <button type="button" class="btn btn-danger" onclick="deleteStudent()">
                        🗑️ Delete Student
                    </button>
                    <button type="button" class="btn btn-outline" onclick="closeModal('editStudentModal')">
                        ❌ Cancel
                    </button>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Global variables
        let currentTheme = 'light';
        let allStudents = [];
        let filteredStudents = [];
        let selectedGender = '';
        let selectedEditGender = '';
        let currentViewMode = 'grid'; // 'grid' or 'table'
        let uploadedFile = null;

        // Initialize the application
        document.addEventListener('DOMContentLoaded', function() {
            initializeApp();
        });

        function initializeApp() {
            // Set max date for DOB to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('dob').max = today;
            document.getElementById('editDob').max = today;
            
            // Load saved theme
            const savedTheme = localStorage.getItem('theme') || 'light';
            if (savedTheme === 'dark') {
                toggleTheme();
            }
            
            // Load initial data
            loadStudents();
            loadStatistics();
            
            // Set up form handlers
            setupFormHandlers();
            
            // Setup drag and drop for file uploads (only for bulk upload)
            setupDragAndDropForBulkUpload();
        }

        function setupFormHandlers() {
            // Student form submission
            document.getElementById('studentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                saveStudent();
            });

            // Edit student form submission
            document.getElementById('editStudentForm').addEventListener('submit', function(e) {
                e.preventDefault();
                updateStudent();
            });

            // File upload handlers (only for bulk upload)
            document.getElementById('excelInput').addEventListener('change', handleFileUpload);
        }

        function setupDragAndDropForBulkUpload() {
            const uploadArea = document.querySelector('#bulk-upload .file-upload-area');
            
            if (uploadArea) {
                uploadArea.addEventListener('dragover', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    this.classList.add('dragover');
                });

                uploadArea.addEventListener('dragleave', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    this.classList.remove('dragover');
                });

                uploadArea.addEventListener('drop', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    this.classList.remove('dragover');
                    
                    const files = e.dataTransfer.files;
                    if (files.length > 0) {
                        // Only take the first file
                        const file = files[0];
                        
                        // Manually set the file to the input and trigger the change event
                        const fileInput = document.getElementById('excelInput');
                        const dataTransfer = new DataTransfer();
                        dataTransfer.items.add(file);
                        fileInput.files = dataTransfer.files;
                        
                        // Trigger the change event
                        handleFileUpload({ target: { files: [file] } });
                    }
                });
            }
        }

        // Theme Toggle
        function toggleTheme() {
            const body = document.body;
            const themeToggle = document.querySelector('.theme-toggle');
            
            if (currentTheme === 'light') {
                body.setAttribute('data-theme', 'dark');
                themeToggle.innerHTML = '☀️ Light Mode';
                currentTheme = 'dark';
            } else {
                body.removeAttribute('data-theme');
                themeToggle.innerHTML = '🌙 Dark Mode';
                currentTheme = 'light';
            }
            
            localStorage.setItem('theme', currentTheme);
        }

        // Tab Management
        function showTab(tabName) {
            // Hide all tab contents
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Remove active class from all tabs
            document.querySelectorAll('.nav-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            
            // Show selected tab
            document.getElementById(tabName).classList.add('active');
            
            // Add active class to clicked tab
            event.target.classList.add('active');
            
            // Load data if needed
            if (tabName === 'view-students') {
                loadStudents();
            }
        }

        // Gender Selection
        function selectGender(gender) {
            selectedGender = gender;
            document.getElementById('gender').value = gender;
            
            document.querySelectorAll('.gender-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            document.querySelector(`[data-gender="${gender}"]`).classList.add('selected');
        }

        function selectEditGender(gender) {
            selectedEditGender = gender;
            document.getElementById('editGender').value = gender;
            
            document.querySelectorAll('#editStudentModal .gender-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            document.querySelector(`#editStudentModal [data-gender="${gender}"]`).classList.add('selected');
        }

        // Age Calculation
        function calculateAge() {
            const dob = document.getElementById('dob').value;
            if (dob) {
                const today = new Date();
                const birthDate = new Date(dob);
                let age = today.getFullYear() - birthDate.getFullYear();
                const monthDiff = today.getMonth() - birthDate.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                
                document.getElementById('age').value = age;
            }
        }

        function calculateEditAge() {
            const dob = document.getElementById('editDob').value;
            if (dob) {
                const today = new Date();
                const birthDate = new Date(dob);
                let age = today.getFullYear() - birthDate.getFullYear();
                const monthDiff = today.getMonth() - birthDate.getMonth();
                
                if (monthDiff < 0 || (monthDiff === 0 && today.getDate() < birthDate.getDate())) {
                    age--;
                }
                
                document.getElementById('editAge').value = age;
            }
        }

        // Photo Upload (removed)
        // function handlePhotoUpload(event) {
        //     // Photo upload functionality removed as requested
        // }

        // File Upload for Bulk
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (file) {
                // Validate file type
                const allowedTypes = [
                    'application/vnd.ms-excel',
                    'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
                    'text/csv'
                ];
                
                if (!allowedTypes.includes(file.type) && !file.name.toLowerCase().endsWith('.csv')) {
                    showAlert('Please select a valid Excel (.xlsx, .xls) or CSV file', 'error');
                    resetFileInput();
                    return;
                }
                
                // Validate file size (10MB limit)
                if (file.size > 10 * 1024 * 1024) {
                    showAlert('File size should be less than 10MB', 'error');
                    resetFileInput();
                    return;
                }
                
                uploadedFile = file;
                displayFilePreview(file);
                document.getElementById('processBtn').disabled = false;
                // Removed the success alert here to prevent double notification
            }
        }

        function displayFilePreview(file) {
            const filePreview = document.getElementById('filePreview');
            const fileName = document.getElementById('fileName');
            const fileDetails = document.getElementById('fileDetails');
            
            // Format file size
            const fileSize = formatFileSize(file.size);
            const fileType = getFileTypeDisplay(file.name);
            
            fileName.textContent = file.name;
            fileDetails.innerHTML = `
                <strong>Type:</strong> ${fileType} | 
                <strong>Size:</strong> ${fileSize} | 
                <strong>Last Modified:</strong> ${new Date(file.lastModified).toLocaleDateString()}
            `;
            
            filePreview.classList.remove('hidden');
            
            // Hide other sections
            document.getElementById('uploadProgress').classList.add('hidden');
            document.getElementById('uploadResults').classList.add('hidden');
            
            // Show single success notification here instead
            showAlert(`File "${file.name}" selected successfully`, 'success');
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        function getFileTypeDisplay(fileName) {
            const extension = fileName.toLowerCase().split('.').pop();
            switch (extension) {
                case 'xlsx': return 'Excel Workbook (.xlsx)';
                case 'xls': return 'Excel 97-2003 (.xls)';
                case 'csv': return 'Comma Separated Values (.csv)';
                default: return 'Unknown';
            }
        }

        function removeFile() {
            resetFileInput();
            document.getElementById('filePreview').classList.add('hidden');
            document.getElementById('processBtn').disabled = true;
            // Removed alert notification here - visual feedback is enough
        }

        function resetFileInput() {
            document.getElementById('excelInput').value = '';
            uploadedFile = null;
        }

        function resetUpload() {
            resetFileInput();
            document.getElementById('filePreview').classList.add('hidden');
            document.getElementById('uploadProgress').classList.add('hidden');
            document.getElementById('uploadResults').classList.add('hidden');
            document.getElementById('processBtn').disabled = true;
        }

        function processUploadedFile() {
            if (!uploadedFile) {
                showAlert('Please select a file first', 'error');
                return;
            }

            // Show progress section
            document.getElementById('uploadProgress').classList.remove('hidden');
            document.getElementById('uploadResults').classList.add('hidden');
            document.getElementById('processBtn').disabled = true;
            
            // Simulate file processing with realistic steps
            const steps = [
                { progress: 10, text: 'Validating file format...' },
                { progress: 25, text: 'Reading file contents...' },
                { progress: 40, text: 'Parsing student data...' },
                { progress: 55, text: 'Validating student records...' },
                { progress: 70, text: 'Checking for duplicates...' },
                { progress: 85, text: 'Saving to database...' },
                { progress: 95, text: 'Generating size recommendations...' },
                { progress: 100, text: 'Upload completed successfully!' }
            ];
            
            let currentStep = 0;
            
            const processStep = () => {
                if (currentStep < steps.length) {
                    const step = steps[currentStep];
                    document.getElementById('progressFill').style.width = step.progress + '%';
                    document.getElementById('progressText').textContent = step.text;
                    currentStep++;
                    
                    // Vary timing to make it feel more realistic
                    const delay = currentStep <= 3 ? 300 : currentStep <= 6 ? 500 : 700;
                    setTimeout(processStep, delay);
                } else {
                    // Simulate completion with results
                    setTimeout(() => {
                        showUploadResults();
                    }, 500);
                }
            };
            
            processStep();
        }

        function showUploadResults() {
            // Hide progress, show results
            document.getElementById('uploadProgress').classList.add('hidden');
            document.getElementById('uploadResults').classList.remove('hidden');
            
            // Simulate realistic results based on file
            const fileName = uploadedFile.name;
            const estimatedRecords = Math.floor(Math.random() * 50) + 10; // 10-60 records
            const successCount = estimatedRecords - Math.floor(Math.random() * 3); // Most successful
            const errorCount = estimatedRecords - successCount;
            
            const resultsHTML = `
                <div class="stats-grid" style="grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                    <div style="text-align: center; padding: 15px; background: var(--white-bg); border-radius: 8px; border: 2px solid var(--success-color);">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--success-color);">${successCount}</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">Successfully Added</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: var(--white-bg); border-radius: 8px; border: 2px solid var(--danger-color);">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--danger-color);">${errorCount}</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">Errors/Duplicates</div>
                    </div>
                    <div style="text-align: center; padding: 15px; background: var(--white-bg); border-radius: 8px; border: 2px solid var(--secondary-color);">
                        <div style="font-size: 1.8rem; font-weight: bold; color: var(--secondary-color);">${estimatedRecords}</div>
                        <div style="font-size: 0.9rem; color: var(--text-secondary);">Total Records</div>
                    </div>
                </div>
                
                <div style="background: var(--white-bg); padding: 15px; border-radius: 8px; border-left: 4px solid var(--secondary-color);">
                    <h5 style="margin: 0 0 10px 0; color: var(--text-primary);">📄 Processed File: ${fileName}</h5>
                    <p style="margin: 0; color: var(--text-secondary); font-size: 0.9rem;">
                        File processed successfully with ${successCount} students added to the system. 
                        ${errorCount > 0 ? `${errorCount} records had errors (likely duplicates or invalid data).` : 'All records processed without errors!'}
                    </p>
                </div>
                
                ${errorCount > 0 ? `
                <div style="background: #fff3cd; padding: 15px; border-radius: 8px; border-left: 4px solid var(--warning-color); margin-top: 15px;">
                    <h6 style="margin: 0 0 5px 0; color: #856404;">⚠️ Common Issues Found:</h6>
                    <ul style="margin: 0; padding-left: 20px; color: #856404; font-size: 0.9rem;">
                        <li>Duplicate roll numbers or register numbers</li>
                        <li>Invalid date formats (use YYYY-MM-DD)</li>
                        <li>Missing required fields</li>
                    </ul>
                </div>
                ` : ''}
            `;
            
            document.getElementById('resultsContent').innerHTML = resultsHTML;
            
            // Update statistics and refresh student list
            loadStudents();
            loadStatistics();
            
            // Single final notification with clear completion message
            showAlert(`✅ Bulk upload completed! ${successCount} of ${estimatedRecords} students processed successfully.`, 'success');
        }

        // Save Student
        async function saveStudent() {
            const formData = new FormData(document.getElementById('studentForm'));
            
            // Remove photo handling as requested
            // const photoFile = document.getElementById('photoInput').files[0];
            // if (photoFile) {
            //     formData.append('photo', photoFile);
            // }

            try {
                showAlert('Saving student profile...', 'info');
                
                // Simulate API call (replace with actual API endpoint)
                await new Promise(resolve => setTimeout(resolve, 1500));
                
                showAlert('✅ Student profile saved successfully!', 'success');
                loadStudents();
                loadStatistics();
                
                // Ask if user wants to add another student
                setTimeout(() => {
                    if (confirm('Student saved successfully! Would you like to add another student?')) {
                        clearForm();
                    }
                }, 2000);
                
            } catch (error) {
                console.error('Error saving student:', error);
                showAlert('Error saving student profile. Please try again.', 'error');
            }
        }

        function saveAndAddNew() {
            saveStudent().then(() => {
                clearForm();
                showAlert('Ready to add new student', 'info');
            });
        }

        // Clear Form
        function clearForm() {
            document.getElementById('studentForm').reset();
            document.getElementById('age').value = '';
            document.getElementById('gender').value = '';
            selectedGender = '';
            
            document.querySelectorAll('.gender-btn').forEach(btn => {
                btn.classList.remove('selected');
            });
            
            // Remove photo preview clearing since photo upload is removed
            // document.getElementById('photoPreview').classList.add('hidden');
            // document.getElementById('photoInput').value = '';
            
            showAlert('Form cleared successfully', 'success');
        }

        // Load Students
        async function loadStudents() {
            const loadingIndicator = document.getElementById('loadingIndicator');
            loadingIndicator.classList.remove('hidden');
            
            try {
                // Simulate API call (replace with actual endpoint)
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                // Sample data (replace with actual API response)
                allStudents = [
                    {
                        id: 1,
                        rollNumber: '2024001',
                        regNumber: 'REG001',
                        studentName: 'John Doe',
                        class: '10',
                        division: 'A',
                        dob: '2008-05-15',
                        age: 16,
                        gender: 'M',
                        height: 165,
                        weight: 55,
                        parentContact: '9876543210',
                        address: '123 Main St, City',
                        status: 'Active'
                    },
                    {
                        id: 2,
                        rollNumber: '2024002',
                        regNumber: 'REG002',
                        studentName: 'Jane Smith',
                        class: '10',
                        division: 'A',
                        dob: '2008-03-20',
                        age: 16,
                        gender: 'F',
                        height: 160,
                        weight: 50,
                        parentContact: '9876543211',
                        address: '456 Oak Ave, City',
                        status: 'Active'
                    },
                    {
                        id: 3,
                        rollNumber: '2024003',
                        regNumber: 'REG003',
                        studentName: 'Mike Johnson',
                        class: '9',
                        division: 'B',
                        dob: '2009-07-10',
                        age: 15,
                        gender: 'M',
                        height: 158,
                        weight: 48,
                        parentContact: '9876543212',
                        address: '789 Pine Rd, City',
                        status: 'Active'
                    }
                ];
                
                filteredStudents = [...allStudents];
                displayStudents();
                populateFilterOptions();
                
            } catch (error) {
                console.error('Error loading students:', error);
                showAlert('Error loading students. Please try again.', 'error');
            } finally {
                loadingIndicator.classList.add('hidden');
            }
        }

        // Display Students
        function displayStudents() {
            if (currentViewMode === 'grid') {
                displayStudentsGrid();
            } else {
                displayStudentsTable();
            }
        }

        function displayStudentsGrid() {
            const container = document.getElementById('studentsGrid');
            container.innerHTML = '';
            
            if (filteredStudents.length === 0) {
                container.innerHTML = '<p class="text-center" style="grid-column: 1/-1; color: var(--text-secondary); font-size: 1.2rem;">No students found</p>';
                return;
            }
            
            filteredStudents.forEach(student => {
                const card = document.createElement('div');
                card.className = 'student-card';
                card.innerHTML = `
                    <div class="student-header">
                        <div class="student-info">
                            <h4>${student.studentName}</h4>
                            <div class="student-meta">
                                <strong>Roll:</strong> ${student.rollNumber}<br>
                                <strong>Class:</strong> ${student.class}-${student.division}<br>
                                <strong>Gender:</strong> ${student.gender === 'M' ? '👦 Male' : '👧 Female'}<br>
                                <strong>Age:</strong> ${student.age} years<br>
                                <strong>Height:</strong> ${student.height}cm | <strong>Weight:</strong> ${student.weight}kg
                            </div>
                        </div>
                        <div style="text-align: center;">
                            <div style="padding: 8px 16px; background: var(--success-color); color: white; border-radius: 20px; font-size: 0.8rem; font-weight: 600;">
                                ${student.status}
                            </div>
                        </div>
                    </div>
                    <div class="student-actions">
                        <button class="btn btn-sm" onclick="editStudent(${student.id})">
                            ✏️ Edit
                        </button>
                        <button class="btn btn-success btn-sm" onclick="viewProfile(${student.id})">
                            👁️ View
                        </button>
                        <button class="btn btn-warning btn-sm" onclick="approveStudent(${student.id})">
                            ✅ Approve
                        </button>
                    </div>
                `;
                container.appendChild(card);
            });
        }

        function displayStudentsTable() {
            const tableBody = document.getElementById('studentsTableBody');
            tableBody.innerHTML = '';
            
            if (filteredStudents.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="9" class="text-center" style="color: var(--text-secondary);">No students found</td></tr>';
                return;
            }
            
            filteredStudents.forEach(student => {
                const row = document.createElement('tr');
                row.innerHTML = `
                    <td><strong>${student.rollNumber}</strong></td>
                    <td>${student.studentName}</td>
                    <td>${student.class}-${student.division}</td>
                    <td>${student.gender === 'M' ? '👦 Male' : '👧 Female'}</td>
                    <td>${student.age}</td>
                    <td>${student.height}cm</td>
                    <td>${student.weight}kg</td>
                    <td><span style="padding: 4px 12px; background: var(--success-color); color: white; border-radius: 15px; font-size: 0.8rem;">${student.status}</span></td>
                    <td>
                        <div style="display: flex; gap: 5px;">
                            <button class="btn btn-sm" onclick="editStudent(${student.id})" title="Edit">✏️</button>
                            <button class="btn btn-success btn-sm" onclick="viewProfile(${student.id})" title="View">👁️</button>
                            <button class="btn btn-warning btn-sm" onclick="approveStudent(${student.id})" title="Approve">✅</button>
                        </div>
                    </td>
                `;
                tableBody.appendChild(row);
            });
        }

        // Toggle View Mode
        function toggleViewMode() {
            const button = event.target;
            const gridView = document.getElementById('studentsGrid');
            const tableView = document.getElementById('studentsTable');
            
            if (currentViewMode === 'grid') {
                currentViewMode = 'table';
                gridView.classList.add('hidden');
                tableView.classList.remove('hidden');
                button.innerHTML = '📋 Grid View';
            } else {
                currentViewMode = 'grid';
                tableView.classList.add('hidden');
                gridView.classList.remove('hidden');
                button.innerHTML = '📋 Table View';
            }
            
            displayStudents();
        }

        // Filter Functions
        function populateFilterOptions() {
            const classes = [...new Set(allStudents.map(s => s.class))].sort();
            const divisions = [...new Set(allStudents.map(s => s.division))].sort();
            
            const classFilter = document.getElementById('classFilter');
            const divisionFilter = document.getElementById('divisionFilter');
            
            classFilter.innerHTML = '<option value="">All Classes</option>' +
                classes.map(c => `<option value="${c}">Class ${c}</option>`).join('');
            
            divisionFilter.innerHTML = '<option value="">All Divisions</option>' +
                divisions.map(d => `<option value="${d}">Division ${d}</option>`).join('');
        }

        function filterStudents() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const genderFilter = document.getElementById('genderFilter').value;
            const classFilter = document.getElementById('classFilter').value;
            const divisionFilter = document.getElementById('divisionFilter').value;

            filteredStudents = allStudents.filter(student => {
                const matchesSearch = !searchTerm || 
                    student.studentName.toLowerCase().includes(searchTerm) ||
                    student.rollNumber.toLowerCase().includes(searchTerm) ||
                    student.regNumber.toLowerCase().includes(searchTerm);
                
                const matchesGender = !genderFilter || student.gender === genderFilter;
                const matchesClass = !classFilter || student.class === classFilter;
                const matchesDivision = !divisionFilter || student.division === divisionFilter;
                
                return matchesSearch && matchesGender && matchesClass && matchesDivision;
            });

            displayStudents();
        }

        function clearFilters() {
            document.getElementById('searchInput').value = '';
            document.getElementById('genderFilter').value = '';
            document.getElementById('classFilter').value = '';
            document.getElementById('divisionFilter').value = '';
            
            filteredStudents = [...allStudents];
            displayStudents();
            
            showAlert('Filters cleared', 'info');
        }

        // Student Actions
        function editStudent(studentId) {
            const student = allStudents.find(s => s.id === studentId);
            if (!student) {
                showAlert('Student not found', 'error');
                return;
            }
            
            // Populate edit form
            document.getElementById('editStudentId').value = student.id;
            document.getElementById('editRollNumber').value = student.rollNumber;
            document.getElementById('editRegNumber').value = student.regNumber;
            document.getElementById('editStudentName').value = student.studentName;
            document.getElementById('editClass').value = student.class;
            document.getElementById('editDivision').value = student.division;
            document.getElementById('editDob').value = student.dob;
            document.getElementById('editAge').value = student.age;
            document.getElementById('editHeight').value = student.height;
            document.getElementById('editWeight').value = student.weight;
            
            selectEditGender(student.gender);
            
            showModal('editStudentModal');
        }

        function updateStudent() {
            const formData = new FormData(document.getElementById('editStudentForm'));
            const studentId = formData.get('studentId');
            
            try {
                showAlert('Updating student profile...', 'info');
                
                // Simulate API call
                setTimeout(() => {
                    showAlert('✅ Student profile updated successfully!', 'success');
                    closeModal('editStudentModal');
                    loadStudents();
                    loadStatistics();
                }, 1000);
                
            } catch (error) {
                console.error('Error updating student:', error);
                showAlert('Error updating student profile. Please try again.', 'error');
            }
        }

        function deleteStudent() {
            if (!confirm('Are you sure you want to delete this student? This action cannot be undone.')) {
                return;
            }
            
            const studentId = document.getElementById('editStudentId').value;
            
            try {
                showAlert('Deleting student...', 'warning');
                
                // Simulate API call
                setTimeout(() => {
                    showAlert('Student deleted successfully', 'success');
                    closeModal('editStudentModal');
                    loadStudents();
                    loadStatistics();
                }, 1000);
                
            } catch (error) {
                console.error('Error deleting student:', error);
                showAlert('Error deleting student. Please try again.', 'error');
            }
        }

        function viewProfile(studentId) {
            const student = allStudents.find(s => s.id === studentId);
            if (!student) {
                showAlert('Student not found', 'error');
                return;
            }
            
            showAlert(`Viewing profile for ${student.studentName}`, 'info');
            // Implement profile view modal or redirect
        }

        function approveStudent(studentId) {
            const student = allStudents.find(s => s.id === studentId);
            if (!student) {
                showAlert('Student not found', 'error');
                return;
            }
            
            if (confirm(`Approve ${student.studentName} for uniform tailoring?`)) {
                showAlert(`✅ ${student.studentName} approved for tailoring!`, 'success');
                // Update status and refresh
                loadStudents();
            }
        }

        // Advanced Search
        function updateSearchPlaceholder() {
            const method = document.getElementById('searchMethod').value;
            const input = document.getElementById('advancedSearchInput');
            
            const placeholders = {
                general: 'Enter any search term...',
                roll_number: 'Enter roll number (e.g., 2024001)',
                reg_number: 'Enter register number (e.g., REG001)',
                name: 'Enter student name',
                class_division: 'Enter class-division (e.g., 10-A)',
                contact: 'Enter parent contact number'
            };
            
            input.placeholder = placeholders[method] || 'Enter search term...';
        }

        function performAdvancedSearch() {
            const method = document.getElementById('searchMethod').value;
            const searchTerm = document.getElementById('advancedSearchInput').value.trim();
            
            if (!searchTerm) {
                showAlert('Please enter a search term', 'warning');
                return;
            }
            
            showAlert('Searching...', 'info');
            
            // Simulate search
            setTimeout(() => {
                let results = [];
                
                switch (method) {
                    case 'roll_number':
                        results = allStudents.filter(s => 
                            s.rollNumber.toLowerCase().includes(searchTerm.toLowerCase())
                        );
                        break;
                    case 'reg_number':
                        results = allStudents.filter(s => 
                            s.regNumber.toLowerCase().includes(searchTerm.toLowerCase())
                        );
                        break;
                    case 'name':
                        results = allStudents.filter(s => 
                            s.studentName.toLowerCase().includes(searchTerm.toLowerCase())
                        );
                        break;
                    case 'class_division':
                        const [searchClass, searchDiv] = searchTerm.split('-');
                        results = allStudents.filter(s => 
                            s.class === searchClass && s.division === searchDiv?.toUpperCase()
                        );
                        break;
                    case 'contact':
                        results = allStudents.filter(s => 
                            s.parentContact && s.parentContact.includes(searchTerm)
                        );
                        break;
                    default:
                        results = allStudents.filter(s => 
                            s.studentName.toLowerCase().includes(searchTerm.toLowerCase()) ||
                            s.rollNumber.toLowerCase().includes(searchTerm.toLowerCase()) ||
                            s.regNumber.toLowerCase().includes(searchTerm.toLowerCase())
                        );
                }
                
                displaySearchResults(results);
                
            }, 500);
        }

        function displaySearchResults(results) {
            const container = document.getElementById('searchResultsContainer');
            const searchResults = document.getElementById('searchResults');
            
            if (results.length === 0) {
                container.innerHTML = '<p class="text-center" style="color: var(--text-secondary);">No students found matching your search criteria.</p>';
            } else {
                container.innerHTML = results.map(student => `
                    <div class="student-card">
                        <div class="student-header">
                            <div class="student-info">
                                <h4>${student.studentName}</h4>
                                <div class="student-meta">
                                    <strong>Roll:</strong> ${student.rollNumber} | 
                                    <strong>Reg:</strong> ${student.regNumber}<br>
                                    <strong>Class:</strong> ${student.class}-${student.division} | 
                                    <strong>Gender:</strong> ${student.gender === 'M' ? 'Male' : 'Female'}<br>
                                    <strong>Age:</strong> ${student.age} | 
                                    <strong>Height:</strong> ${student.height}cm | 
                                    <strong>Weight:</strong> ${student.weight}kg
                                </div>
                            </div>
                        </div>
                        <div class="student-actions">
                            <button class="btn btn-sm" onclick="editStudent(${student.id})">✏️ Edit</button>
                            <button class="btn btn-success btn-sm" onclick="viewProfile(${student.id})">👁️ View</button>
                        </div>
                    </div>
                `).join('');
            }
            
            searchResults.classList.remove('hidden');
            showAlert(`Found ${results.length} student(s)`, 'success');
        }

        // Reports
        function generateReport() {
            const reportType = document.getElementById('reportType').value;
            const exportFormat = document.getElementById('exportFormat').value;
            
            showAlert('Generating report...', 'info');
            
            setTimeout(() => {
                const reportContent = document.getElementById('reportContent');
                const reportPreview = document.getElementById('reportPreview');
                
                let content = '';
                
                switch (reportType) {
                    case 'class_wise':
                        content = generateClassWiseReport();
                        break;
                    case 'gender_wise':
                        content = generateGenderWiseReport();
                        break;
                    case 'age_wise':
                        content = generateAgeWiseReport();
                        break;
                    case 'height_weight':
                        content = generateHeightWeightReport();
                        break;
                    case 'complete_list':
                        content = generateCompleteListReport();
                        break;
                }
                
                reportContent.innerHTML = content;
                reportPreview.classList.remove('hidden');
                
                showAlert(`✅ ${reportType.replace('_', ' ').toUpperCase()} report generated!`, 'success');
                
            }, 1000);
        }

        function generateClassWiseReport() {
            const classSummary = {};
            
            allStudents.forEach(student => {
                const key = `${student.class}-${student.division}`;
                if (!classSummary[key]) {
                    classSummary[key] = { total: 0, male: 0, female: 0 };
                }
                classSummary[key].total++;
                if (student.gender === 'M') {
                    classSummary[key].male++;
                } else {
                    classSummary[key].female++;
                }
            });
            
            let html = '<table class="data-table"><thead><tr><th>Class</th><th>Total</th><th>Male</th><th>Female</th></tr></thead><tbody>';
            
            Object.entries(classSummary).forEach(([classDiv, data]) => {
                html += `<tr><td>${classDiv}</td><td>${data.total}</td><td>${data.male}</td><td>${data.female}</td></tr>`;
            });
            
            html += '</tbody></table>';
            return html;
        }

        function generateGenderWiseReport() {
            const male = allStudents.filter(s => s.gender === 'M').length;
            const female = allStudents.filter(s => s.gender === 'F').length;
            const total = allStudents.length;
            
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${male}</div>
                        <div class="stat-label">Male Students (${((male/total)*100).toFixed(1)}%)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${female}</div>
                        <div class="stat-label">Female Students (${((female/total)*100).toFixed(1)}%)</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${total}</div>
                        <div class="stat-label">Total Students</div>
                    </div>
                </div>
            `;
        }

        function generateAgeWiseReport() {
            const ageGroups = {
                '5-8': 0, '9-12': 0, '13-15': 0, '16-18': 0
            };
            
            allStudents.forEach(student => {
                const age = student.age;
                if (age >= 5 && age <= 8) ageGroups['5-8']++;
                else if (age >= 9 && age <= 12) ageGroups['9-12']++;
                else if (age >= 13 && age <= 15) ageGroups['13-15']++;
                else if (age >= 16 && age <= 18) ageGroups['16-18']++;
            });
            
            let html = '<table class="data-table"><thead><tr><th>Age Group</th><th>Count</th><th>Percentage</th></tr></thead><tbody>';
            const total = allStudents.length;
            
            Object.entries(ageGroups).forEach(([group, count]) => {
                const percentage = ((count/total)*100).toFixed(1);
                html += `<tr><td>${group} years</td><td>${count}</td><td>${percentage}%</td></tr>`;
            });
            
            html += '</tbody></table>';
            return html;
        }

        function generateHeightWeightReport() {
            const heights = allStudents.map(s => s.height);
            const weights = allStudents.map(s => s.weight);
            
            const avgHeight = (heights.reduce((a, b) => a + b, 0) / heights.length).toFixed(1);
            const avgWeight = (weights.reduce((a, b) => a + b, 0) / weights.length).toFixed(1);
            const minHeight = Math.min(...heights);
            const maxHeight = Math.max(...heights);
            const minWeight = Math.min(...weights);
            const maxWeight = Math.max(...weights);
            
            return `
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number">${avgHeight}cm</div>
                        <div class="stat-label">Average Height</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${avgWeight}kg</div>
                        <div class="stat-label">Average Weight</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${minHeight}-${maxHeight}cm</div>
                        <div class="stat-label">Height Range</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number">${minWeight}-${maxWeight}kg</div>
                        <div class="stat-label">Weight Range</div>
                    </div>
                </div>
            `;
        }

        function generateCompleteListReport() {
            let html = '<table class="data-table"><thead><tr><th>Roll No.</th><th>Name</th><th>Class</th><th>Gender</th><th>Age</th><th>Height</th><th>Weight</th>                        <th>Contact</th></tr></thead><tbody>';
            
            allStudents.forEach(student => {
                html += `
                    <tr>
                        <td>${student.rollNumber}</td>
                        <td>${student.studentName}</td>
                        <td>${student.class}-${student.division}</td>
                        <td>${student.gender === 'M' ? 'Male' : 'Female'}</td>
                        <td>${student.age}</td>
                        <td>${student.height}cm</td>
                        <td>${student.weight}kg</td>
                        <td>${student.parentContact || 'N/A'}</td>
                    </tr>
                `;
            });
            
            html += '</tbody></table>';
            return html;
        }

        // Statistics
        function loadStatistics() {
            const total = allStudents.length;
            const male = allStudents.filter(s => s.gender === 'M').length;
            const pending = Math.floor(total * 0.3); // Simulate pending profiles
            const completed = total - pending;
            
            document.getElementById('totalStudents').textContent = total;
            document.getElementById('pendingProfiles').textContent = pending;
            document.getElementById('completedProfiles').textContent = completed;
            document.getElementById('maleStudents').textContent = male;
        }

        // Utility Functions
        function downloadTemplate() {
            // Create a sample CSV template (updated format)
            const headers = ['Roll Number', 'Register Number', 'Student Name', 'Class', 'Division', 'DOB (YYYY-MM-DD)', 'Gender (M/F)', 'Height (cm)', 'Weight (kg)'];
            const sampleData = ['2024001', 'REG001', 'John Doe', '10', 'A', '2008-05-15', 'M', '165', '55'];
            
            const csvContent = [headers.join(','), sampleData.join(',')].join('\n');
            const blob = new Blob([csvContent], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            
            const a = document.createElement('a');
            a.href = url;
            a.download = 'student_template.csv';
            a.click();
            
            window.URL.revokeObjectURL(url);
            showAlert('Template downloaded successfully!', 'success');
        }

        function showNotifications() {
            showAlert('📧 You have 3 new notifications: 2 pending approvals, 1 new student registration', 'info');
        }

        // Modal Management
        function showModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.style.display = 'block';
            setTimeout(() => modal.classList.add('show'), 10);
        }

        function closeModal(modalId) {
            const modal = document.getElementById(modalId);
            modal.classList.remove('show');
            setTimeout(() => modal.style.display = 'none', 300);
        }

        // Alert System
        function showAlert(message, type = 'info') {
            const alertContainer = document.getElementById('alertContainer');
            const alertId = 'alert_' + Date.now();
            
            const icons = {
                success: '✅',
                error: '❌',
                warning: '⚠️',
                info: 'ℹ️'
            };
            
            const alert = document.createElement('div');
            alert.id = alertId;
            alert.className = `alert alert-${type}`;
            alert.innerHTML = `
                <span>${icons[type] || 'ℹ️'}</span>
                <span>${message}</span>
                <button onclick="removeAlert('${alertId}')" style="background: none; border: none; color: inherit; font-size: 1.2rem; cursor: pointer; margin-left: auto;">&times;</button>
            `;
            
            alertContainer.appendChild(alert);
            
            // Auto remove after 5 seconds
            setTimeout(() => removeAlert(alertId), 5000);
        }

        function removeAlert(alertId) {
            const alert = document.getElementById(alertId);
            if (alert) {
                alert.style.opacity = '0';
                alert.style.transform = 'translateX(100%)';
                setTimeout(() => alert.remove(), 300);
            }
        }

        // Close modals when clicking outside
        window.onclick = function(event) {
            const modals = document.querySelectorAll('.modal');
            modals.forEach(modal => {
                if (event.target === modal) {
                    closeModal(modal.id);
                }
            });
        }

        // Keyboard shortcuts
        document.addEventListener('keydown', function(e) {
            // Ctrl+S to save form
            if (e.ctrlKey && e.key === 's') {
                e.preventDefault();
                const activeTab = document.querySelector('.tab-content.active');
                if (activeTab.id === 'student-entry') {
                    saveStudent();
                }
            }
            
            // Escape to close modals
            if (e.key === 'Escape') {
                const openModal = document.querySelector('.modal.show');
                if (openModal) {
                    closeModal(openModal.id);
                }
            }
        });
    </script>
</body>
</html>